Service Name,Published Properties,PassthroughSubject Streams,Consuming Services,Stream Purpose
BLECommunicationService,"connectionState: BLEConnectionState, latestPosition: PositionData?, latestRadioChannel: RadioChannelData?, latestSettings: SettingsData?, deviceSettings: DeviceSettings, deviceStatus: DeviceStatusData?, afcFrequencies: [Int], afcMovingAverage: Int, connectionStatus: ConnectionStatus, lastMessageTimestamp: Date?","positionDataStream: PassthroughSubject<PositionData Never>, radioChannelDataStream: PassthroughSubject<RadioChannelData Never>, settingsDataStream: PassthroughSubject<SettingsData Never>","BalloonPositionService, MapPresenter, DataPanelView, SettingsView","Three-channel BLE data architecture: Position channel (Type 1), Radio channel (Types 0,2), Settings channel (Type 3). Provides unified connection state and real-time telemetry from MySondyGo devices"
APRSDataService,"latestPosition: PositionData?, latestRadioChannel: RadioChannelData?, connectionStatus: ConnectionStatus, bleSerialName: String?, aprsSerialName: String?","positionDataStream: PassthroughSubject<PositionData Never>, radioChannelDataStream: PassthroughSubject<RadioChannelData Never>","BalloonPositionService, MapPresenter","Three-channel APRS fallback data compatible with BLE architecture. Provides SondeHub API-based telemetry when BLE unavailable"
BalloonPositionService,"currentPositionData: PositionData?, currentRadioChannel: RadioChannelData?, currentBalloonName: String?, dataSource: TelemetrySource, aprsDataAvailable: Bool, currentState: DataState, balloonPhase: BalloonPhase, landingPoint: CLLocationCoordinate2D?, balloonDisplayPosition: CLLocationCoordinate2D?",None,"BalloonTrackService, MapPresenter, ServiceCoordinator, DataPanelView","State machine orchestration for telemetry sources. Arbitrates between BLE and APRS data, manages balloon flight phases (ascending/descending/landed), provides unified position data"
BalloonTrackService,"currentBalloonTrack: [BalloonTrackPoint], currentBalloonName: String?, motionMetrics: BalloonMotionMetrics, landingPosition: CLLocationCoordinate2D?","trackUpdated: PassthroughSubject<Void Never>","MapPresenter, PredictionService, DataPanelView","Balloon track history and motion analysis. Provides smoothed speeds, adjusted descent rates, landing detection, and motion metrics for prediction accuracy"
CurrentLocationService,"locationData: LocationData?, distanceToBalloon: CLLocationDistance?, isWithin200mOfBalloon: Bool, shouldUpdateRoute: Bool",None,"RouteCalculationService, MapPresenter, DataPanelView","User location with dual-mode operation (background/precision). Handles proximity detection, route update triggers, and location accuracy optimization for heading mode"
PredictionService,"latestPrediction: PredictionData?, predictedLandingTimeString: String, remainingFlightTimeString: String",None,"MapPresenter, DataPanelView, LandingPointTrackingService","Balloon landing prediction using SondeHub API. Provides prediction paths, landing points, burst points, and time calculations with intelligent caching"
LandingPointTrackingService,"landingHistory: [LandingPredictionPoint], lastLandingPrediction: LandingPredictionPoint?",None,"MapPresenter, RouteCalculationService","Landing prediction history and route calculation triggering. Acts as service chain coordinator between prediction and routing services"
NavigationService,None,None,ServiceCoordinator,"Apple Maps integration and navigation notifications. Handles external navigation app integration and landing point change notifications"
RouteCalculationService,"currentRoute: RouteData?, isCalculatingRoute: Bool, transportMode: TransportationMode",None,"MapPresenter, DataPanelView","Route calculation to landing points with multi-modal transport (car/bike). Includes fallback strategies for unmappable destinations"
ServiceCoordinator,"startupProgress: String, currentStartupStep: Int, isStartupComplete: Bool, showLogo: Bool, showTrackingMap: Bool, frequencySyncProposal: FrequencySyncProposal?",None,"MapPresenter, BalloonHunterApp, Views","Central orchestration and startup sequence management. Controls service initialization, prediction timer (60s), and cross-service coordination"
MapPresenter,"trackPoints: [BalloonTrackPoint], predictionPath: MKPolyline?, userRoute: MKPolyline?, landingHistory: [LandingPredictionPoint], balloonPosition: PositionData?, balloonRadioChannel: RadioChannelData?, balloonSettings: SettingsData?, annotations: [MapAnnotationItem], isHeadingMode: Bool, transportMode: TransportationMode, region: MKCoordinateRegion?, frequencySyncProposal: FrequencySyncProposal?, smoothedDescentRate: Double?, smoothenedPredictionActive: Bool, staleness information and 20+ more UI properties",None,"TrackingMapView, DataPanelView","Map-specific data transformations and UI state management. Aggregates all service data for map presentation and handles UI-specific logic"
FrequencyManagementService,"syncProposal: FrequencySyncProposal?",None,"ServiceCoordinator, MapPresenter","APRS-BLE frequency synchronization proposals. Manages user confirmation for frequency changes when APRS and BLE settings differ"
PersistenceService,"userSettings: UserSettings, deviceSettings: DeviceSettings?",None,"All Services","Data persistence and caching. Provides UserDefaults and Documents directory storage for settings, tracks, and landing histories"